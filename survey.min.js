"use strict";function inject({tag:e,scope:t="head",...a}){const r=document.createElement(e);return Object.entries(a).forEach(([e,t])=>{r.setAttribute(e,t)}),document[t].appendChild(r),r}const DEFAULT_FORM_VALUES={name:"",email:"",age:"",gender:"",favoriteBook:"",favoriteColors:[]},DEFAULT_CACHE={form:DEFAULT_FORM_VALUES,step:0,errors:{},status:"processing"},ERRORS={required:"Is Required!"},steps=["Identity","Details","Favorites","Summary"];function getStepContent(e){switch(e){case 0:return IdentityForm;case 1:return DetailsForm;case 2:return FavoritesForm;case 3:return Summary;default:throw new Error("Unknown step")}}function getFieldsEmpty(e={}){return Object.entries(e).map(([e,t])=>("string"!=typeof t||!t.trim())&&(!("number"==typeof t&&!isNaN(t))&&((!Array.isArray(t)||!t.length)&&e))).filter(e=>!!e)}const deepMerge=function(){for(var e={},t=0;t<arguments.length;t++){a=void 0;var a,r=arguments[t];for(a in r)r.hasOwnProperty(a)&&("[object Object]"===Object.prototype.toString.call(r[a])?e[a]=deepMerge(e[a],r[a]):e[a]=r[a])}return e},cacheService={save:(e={})=>{var t=JSON.parse(localStorage.getItem("@survey")||"{}"),t=deepMerge(DEFAULT_CACHE,deepMerge(t,e));localStorage.setItem("@survey",JSON.stringify(t))},load:()=>{var e=JSON.parse(localStorage.getItem("@survey")||"{}");return deepMerge(DEFAULT_CACHE,e)}};function Main(){var{Modal:e,Box:t,Fade:a,Container:r}=MaterialUI;const[n,o]=React.useState(!0);React.useEffect(()=>{"submitted"===cacheService.load().status&&o(!1)},[]);return React.createElement(React.Fragment,{},[React.createElement(e,{open:n,onClose:()=>{o(!1)},closeAfterTransition:!0},React.createElement(a,{in:n},React.createElement(r,{component:"div",maxWidth:"sm",sx:{mb:4}},React.createElement(t,{sx:{my:{xs:4,md:6},p:{xs:2,md:3},bgcolor:"background.paper",boxShadow:24}},React.createElement(SurveryForm,{onFinish:()=>o(!1)})))))])}function SurveryForm({onFinish:t}){const{Box:e,Stepper:a,Step:r,StepLabel:n,Button:o,Typography:c}=MaterialUI,[l,i]=React.useState(0),[m,s]=React.useState(DEFAULT_FORM_VALUES),[d,u]=React.useState({});React.useEffect(()=>{var e=cacheService.load();s(e.form||DEFAULT_FORM_VALUES),i(e.step),u(e.errors),R(e.form,e.step)},[]);const p=(t,a)=>{u(e=>{e={...e,[l]:{...e[l],[t]:a}};return v(e),e})},g=e=>{cacheService.save({step:e})},v=e=>{cacheService.save({errors:e})},R=(e,t)=>{e={0:{name:e.name,email:e.email},1:{age:e.age,gender:e.gender},2:{favoriteBook:e.favoriteBook,favoriteColors:e.favoriteColors}};if(0<t){const a=getFieldsEmpty(e[t]);if(a.length)return a.forEach(e=>p(e,ERRORS.required)),!1}return u({}),!0};return React.createElement(e,{component:"form",onSubmit:e=>{e.preventDefault(),e=!0,cacheService.save({status:e?"submitted":"processing"}),t()}},[React.createElement(c,{component:"h1",variant:"h4",align:"center"},"Survey"),React.createElement(a,{activeStep:l,sx:{pt:3,pb:5}},steps.map((e,t)=>React.createElement(r,{key:e.toString()},React.createElement(n,{error:Object.values(d[t]||{}).filter(e=>!!e).length},e)))),React.createElement(getStepContent(l),{form:m,errors:d[l],handleUpdateForm:(a,r)=>{s(e=>{var t,e=Object.assign({},e,{[a]:r});return t=e,cacheService.save({form:t}),e})},reportError:p}),React.createElement(e,{sx:{display:"flex",justifyContent:"flex-end"}},[0!==l?React.createElement(o,{onClick:()=>{var e;0<=l-1&&(e=l-1,i(e),g(e))},sx:{mt:3,ml:1}},"Previous"):null,l<steps.length-1?React.createElement(o,{variant:"contained",onClick:()=>{var e;R(m,l)&&l+1<steps.length&&(e=l+1,i(e),g(e))},sx:{mt:3,ml:1},disabled:Object.values(d[l]||{}).filter(e=>!!e).length},"Next"):null,l===steps.length-1?React.createElement(o,{variant:"contained",type:"submit",sx:{mt:3,ml:1},disabled:Object.values(d[l]||{}).filter(e=>!!e).length},"Submit"):null])])}function IdentityForm({form:e,handleUpdateForm:t,errors:a={}}){var{Box:r,Typography:n,Grid:o,TextField:c}=MaterialUI,l=e=>"name"===e.target.name?t("name",e.target.value,e):"email"===e.target.name?t("email",e.target.value,e):void 0;return React.createElement(r,{},[React.createElement(n,{variant:"h6",gutterBottom:!0},"Identity"),React.createElement(o,{container:!0,spacing:3},[React.createElement(o,{item:!0,xs:12,sm:12},React.createElement(c,{required:!1,id:"name",name:"name",label:"Name",fullWidth:!0,autoComplete:"given-name",variant:"standard",value:e.name,error:a.name,helperText:a.name,onChange:l})),React.createElement(o,{item:!0,xs:12,sm:12},React.createElement(c,{required:!1,id:"email",name:"email",label:"E-mail",fullWidth:!0,autoComplete:"email",variant:"standard",value:e.email,error:a.email,helperText:a.email,onChange:l}))])])}const genderOptions=["woman","man","transgender","non-binary/non-conforming","prefer not to respond"];function DetailsForm({form:t,handleUpdateForm:r,errors:e={},reportError:n}){const{Box:a,Typography:o,Grid:c,Select:l,FormLabel:i,FormControl:m,FormControlLabel:s,InputLabel:d,RadioGroup:u,Radio:p,MenuItem:g,FormHelperText:v}=MaterialUI,R=e=>{var t=e.target.name;const a=e.target.value;return"age"===t?(a?n(t,null):n(t,ERRORS.required),r(t,a)):"gender"===t?(a?n(t,null):n(t,ERRORS.required),r(t,a.toLowerCase())):void 0};return React.createElement(a,{},[React.createElement(o,{variant:"h6",gutterBottom:!0},"Details"),React.createElement(c,{container:!0,spacing:3},[React.createElement(c,{item:!0,xs:12,sm:12},React.createElement(m,{fullWidth:!0,required:!0,error:e.age},[React.createElement(d,{variant:"standard"},"Age"),React.createElement(l,{name:"age",label:"Age",fullWidth:!0,variant:"standard",value:t.age,onChange:R},new Array(100).fill(null).map((e,t)=>React.createElement(g,{value:t+1},t+1))),e.age&&React.createElement(v,{},e.age)])),React.createElement(c,{item:!0,xs:12,sm:12},[React.createElement(m,{fullWidth:!0,required:!0,error:e.gender},[React.createElement(i,{id:"gender-group-label"},"Gender"),genderOptions.map(e=>React.createElement(u,{item:!0,xs:3,sm:3},React.createElement(s,{id:"gender-"+e,name:"gender",label:e,value:e,control:React.createElement(p,{}),checked:t.gender.toLowerCase()===e.toLowerCase(),onChange:R,sx:{textTransform:"capitalize"}}))),e.gender&&React.createElement(v,{},e.gender)])])])])}const colorOptions=["black","silver","gray","white","maroon","red","purple","pink","green","lime","olive","yellow","navy","blue","teal","aqua"];function FavoritesForm({form:t,handleUpdateForm:r,errors:e={},reportError:n}){const{Box:a,Typography:o,Grid:c,TextField:l,FormControl:i,InputLabel:m,Select:s,MenuItem:d,Checkbox:u,ListItemText:p,FormHelperText:g}=MaterialUI;var v=e=>{var t=e.target.name;const a=e.target.value;return"favoriteBook"===t?(a?n("favoriteBook",null):n("favoriteBook",ERRORS.required),r("favoriteBook",a,e)):"favoriteColors"===t?(a.length?n(t,null):n(t,ERRORS.required),r(t,"string"==typeof a?a.split(","):[...new Set(a)],e)):void 0};return React.createElement(a,{},[React.createElement(o,{variant:"h6",gutterBottom:!0},"Favorites"),React.createElement(c,{container:!0,spacing:3},[React.createElement(c,{item:!0,xs:12,sm:12},React.createElement(l,{required:!0,id:"favorite-book",name:"favoriteBook",label:"Favorite Book",fullWidth:!0,variant:"standard",value:t.favoriteBook,error:e.favoriteBook,helperText:e.favoriteBook,onChange:v})),React.createElement(c,{item:!0,xs:12,sm:12},React.createElement(i,{fullWidth:!0,required:!0,error:e.favoriteColors},[React.createElement(m,{variant:"standard"},"Favorite colors"),React.createElement(s,{label:"Favorite colors",name:"favoriteColors",fullWidth:!0,multiple:!0,value:[...new Set(t.favoriteColors)],onChange:v,variant:"standard",renderValue:e=>e.join(", ")},colorOptions.map(e=>React.createElement(d,{key:e,value:e},[React.createElement(u,{checked:t.favoriteColors.includes(e),sx:{color:e,"&.Mui-checked":{color:e}}}),React.createElement(p,{primary:e})]))),e.favoriteColors&&React.createElement(g,{},e.favoriteColors)]))])])}const maplabelsAndFieldsForm=[{category:"Identity",fields:[{field:"name",label:"Name",renderBy:(e="")=>e.trim()||"anonymous",sx:{textTransform:"capitalize"}},{field:"email",label:"Email",renderBy:(e="")=>e.trim()||"anonymous"}]},{category:"Details",fields:[{field:"age",label:"Age"},{field:"gender",label:"Gender",sx:{textTransform:"capitalize"}}]},{category:"Favorites",fields:[{field:"favoriteBook",label:"Favotire Book"},{field:"favoriteColors",label:"Favotire Colors",renderBy:e=>e.join(", "),sx:{textTransform:"capitalize"}}]}];function Summary({form:n}){const{Box:e,Grid:o,Typography:c,Divider:r}=MaterialUI;return React.createElement(e,{},[React.createElement(c,{variant:"h6",gutterBottom:!0},"Summary"),React.createElement(o,{container:!0,spacing:2},[React.createElement(o,{item:!0,xs:12,sm:12},[maplabelsAndFieldsForm.map(({category:e,fields:t},a)=>React.createElement(React.Fragment,{},[0<a&&React.createElement(r,{sx:{mt:2}}),React.createElement(c,{variant:"h5",gutterBottom:!0,sx:{mt:2}},e),React.createElement(o,{container:!0},t.map(({label:e,field:t,renderBy:a,sx:r={}})=>React.createElement(React.Fragment,{},[React.createElement(o,{item:!0,xs:6},React.createElement(c,{gutterBottom:!0},e)),(n&&t&&n[t]||a)&&React.createElement(o,{item:!0,xs:6},React.createElement(c,{gutterBottom:!0,sx:{wordWrap:"break-word",...r}},a?a(n[t]):n[t]))])))]))])])])}function setup(t=0){try{window.React&&window.ReactDOM&&window.MaterialUI&&inject({tag:"div",scope:"body",id:"survey"}),ReactDOM.render(React.createElement(Main),document.querySelector("#survey"))}catch(e){t<5&&[window.React,window.ReactDOM,window.MaterialUI].some(e=>!e)&&setTimeout(()=>setup(t+1),500)}}const dependencies={react:"https://unpkg.com/react@17/umd/react.production.min.js",reactDom:"https://unpkg.com/react-dom@17/umd/react-dom.production.min.js",font:"https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap",materialUI:"https://unpkg.com/@mui/material@latest/umd/material-ui.production.min.js"};(async()=>{"submitted"!==cacheService.load().status&&(inject({tag:"script",scope:"head",src:dependencies.react,crossorigin:!0}),inject({tag:"script",scope:"head",src:dependencies.reactDom,crossorigin:!0}),inject({tag:"link",scope:"head",rel:"stylesheet",href:dependencies.font}),inject({tag:"script",scope:"head",src:dependencies.materialUI}),setTimeout(setup,2e3))})();